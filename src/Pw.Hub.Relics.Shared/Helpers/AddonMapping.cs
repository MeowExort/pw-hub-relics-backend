namespace Pw.Hub.Relics.Shared.Helpers;

/// <summary>
/// Справочник для маппинга AddonId на RelicAttributeId (type).
/// </summary>
public static class AddonMapping
{
    private static readonly Dictionary<int, int> AddonToRelicAttributeType = new();

    static AddonMapping()
    {
        // type: 0
        RegisterAddons(0, new[]
        {
            411, 413, 415, 476, 478,
            481, 753, 754, 756, 755,
            757, 758, 759, 760, 761,
            762, 763, 1009, 1008, 1007,
            1006, 784, 785, 786, 787,
            788, 789, 790, 791, 792,
            793, 794, 994, 995, 996,
            997, 1401, 1402, 1403, 1404,
            1405, 341, 342, 343, 586,
            848, 849, 850, 852, 857,
            858, 859, 860, 855, 1011,
            1010, 1012, 1013, 2020, 2022,
            3036, 3040, 3295, 3296, 3297,
            3298, 3299, 3300, 1150, 1152,
            2884, 1144, 1146, 1148, 2447, 2449,
            2451, 3398,
            3514, 3531, 3548,
            3918, 3884, 3909, 3872, 3897, 3885, 3954, 3873, 3908, 3896
        });

        // type: 3
        RegisterAddons(3, new[]
        {
            422, 434, 436, 483, 485,
            488, 809, 810, 811, 813,
            814, 815, 816, 817, 818,
            820, 821, 990, 991, 992,
            993, 348, 349, 350, 588,
            885, 886, 887, 889, 890,
            891, 892, 893, 895, 1018,
            1019, 1020, 1022, 1160,
            1162, 1423, 1424, 1425,
            1426, 1427, 2023, 2882, 3038,
            3042, 3301, 3302, 3303, 3304,
            3305, 3306, 561, 562, 563,
            564, 1154, 1156, 1158, 2453,
            2455, 2466, 3400, 3515, 3532, 3549,
            3919, 3886, 3911, 3874, 3899, 3887, 3952, 3875, 3910, 3898
        });

        // type: 12
        RegisterAddons(12, new[]
        {
            477, 479, 482, 1244, 1245,
            1246, 1247, 1248, 1249, 1250,
            1251, 1252, 1253, 1254, 1255,
            1256, 1257, 1420, 216, 217,
            218, 219, 220, 590, 598,
            599, 600, 601, 652, 653,
            654, 655, 656, 657, 658,
            659, 660, 661, 1058, 1057,
            1056, 1055, 359, 360, 361,
            909, 910, 911, 912, 913,
            914, 915, 916, 917, 918,
            919, 1027, 1028, 1029, 1030,
            3032, 3136, 3137, 3138, 3139,
            3199, 3279, 3280, 3281, 3282, 3283,
            3284, 3285, 3286, 1151, 1153, 2885,
            2435, 2439, 2443, 2469, 557, 558,
            559, 560, 1145, 1147, 1149, 2448, 2450, 2452,
            3399, 3734,
            3868, 3881, 3915, 3869, 3916, 3904, 3905, 3892, 3893, 3880
        });

        // type: 14
        RegisterAddons(14, new[]
        {
            484, 486, 489, 306, 307,
            308, 309, 310, 380, 381,
            382, 1565, 2109, 2110, 2111,
            2112, 2113, 2114, 2115, 2116,
            3034, 3140, 3141, 3142, 3143,
            3200, 3287, 3288, 3289, 3290,
            3291, 3292, 3293, 3294, 1161,
            1163, 2883, 2436, 2440, 2444,
            565, 566, 567, 568, 1155, 1157,
            1159, 2454, 2456, 2467, 3401,
            3735,
            3895, 3882, 3870, 3883, 3871, 3951, 3906, 3917, 3894, 3907
        });

        // type: 35
        RegisterAddons(35, new[]
        {
            1239, 1240,
            1241, 1242, 1243, 1335, 1336,
            1337, 1338, 1339, 1340, 1341,
            1342, 1343, 1344, 1411, 1412,
            1413, 1414, 1415, 1416, 266,
            267, 268, 269, 270, 626,
            627, 628, 629, 630, 1345,
            1346, 1347, 1348, 1349, 1370,
            1371, 1372, 1373, 1374, 1375,
            1376, 1377, 1378, 1379, 1380,
            1381, 1382, 1383, 1384, 1997,
            1998, 1999, 2000, 2001, 3019,
            3269, 3270, 3271, 3272, 3273,
            3274, 3275, 3276, 3277, 3278,
            2438, 2442, 2446, 2468, 2809,
            2812, 2815, 2818, 2821, 2824,
            2827, 2830, 2833, 2836, 2891,
            2894, 2897, 3115, 3119, 3123,
            577, 578, 579, 580, 1174, 1175,
            1176, 2463, 2464, 3559, 3560,
            3561, 3567, 3568, 3569, 3575,
            3576, 3577, 3726, 3843, 3844,
            3845, 3848, 3849, 3850,
            3866, 3879, 3914, 3867, 3953, 3902, 3903, 3890, 3891, 3878
        });

        // type: 36
        RegisterAddons(36, new[]
        {
            500, 501, 502, 1234, 1235,
            1236, 1237, 1238, 1325, 1326,
            1327, 1328, 1329, 1330, 1331,
            1332, 1333, 1334, 276, 277,
            278, 279, 280, 631, 632,
            633, 634, 635, 1350, 1351,
            1352, 1353, 1354, 1355, 1356,
            1357, 1358, 1359, 1360, 1361,
            1362, 1363, 1364, 1365, 1366,
            1367, 1368, 1369, 2002, 2003,
            2004, 2005, 2006, 2117, 2118,
            2119, 2120, 2121, 2122, 2123,
            2124, 2125, 1182, 1183, 2437,
            2441, 2445, 581, 582, 583, 584,
            1179, 1180, 1181,
            3922, 3923, 3924, 3925, 3955, 3926, 3927, 3928, 3929, 3930
        });

        // type: 46
        RegisterAddons(46, new[]
        {
            490, 492, 494, 1311, 1312,
            1313, 1314, 1315, 1316, 1317,
            1318, 1319, 1320, 1321, 1322,
            1323, 1324, 1406, 1407, 1408,
            1385, 1386, 1387, 1388, 1389,
            1390, 1391, 1392, 1393, 1395,
            1396, 1397, 1398, 1399, 3029,
            1170, 1172, 2470, 569, 570,
            571, 572, 1164, 1166, 1168,
            2457, 2459, 2461, 3442, 3464,
            3486,
            3931, 3932, 3933, 3934, 3935, 3936, 3937, 3938, 3939, 3940
        });

        // type: 50
        RegisterAddons(50, new[]
        {
            491, 493, 495, 1258, 1259,
            1260, 1261, 1262, 1263, 1264,
            1265, 1266, 1267, 1268, 1269,
            1270, 1271, 1409, 1410, 641,
            642, 643, 644, 645, 662,
            663, 664, 665, 666, 667,
            668, 669, 670, 671, 1062,
            1061, 1060, 1059, 593, 596,
            597, 920, 921, 922, 923,
            924, 925, 926, 927, 928,
            929, 930, 1031, 1032, 1033,
            1034, 3030, 1171, 1173, 573,
            574, 575, 576, 1165, 1167,
            1169, 2458, 2460, 2462,
            3941, 3942, 3943, 3944, 3945, 3946, 3947, 3948, 3949, 3950
        });

        // type: 59
        RegisterAddons(59, new[]
        {
            2029, 2030, 2031, 2032, 2033,
            2034, 2035, 2036, 2037, 2038,
            2065, 2066, 2067, 2068, 2069,
            2070, 2071, 2072, 2073, 2074,
            2075, 2076, 2077, 2078, 2079,
            2080, 2081, 2082, 2083, 2084,
            2098, 2099, 2100, 2101, 2142,
            2143, 2149, 2150, 2151, 2268,
            2974, 2975, 2976, 2977, 2978,
            3009, 3110, 3152, 3195,
            3205, 3206, 3207, 3208, 3203,
            3230, 3263, 3264, 3312, 2284,
            2287, 2290, 2293, 2296,
            2314, 2316, 2319, 2321, 2324,
            2326, 2329, 2331, 2334, 2336,
            2339, 2341, 2344, 2346, 2349,
            2351, 2354, 2356, 2359, 2361,
            2761, 2763, 2766, 2768, 2771,
            2773, 2776, 2778, 2781, 2783,
            2786, 2788, 2791, 2793, 2796,
            2798, 2801, 2803, 2806, 2808,
            2811, 2814, 2817, 2820, 2823,
            2826, 2829, 2832, 2835, 2838,
            2893, 2896, 2899, 2903, 2907,
            2911, 2928, 2933, 2938, 2943,
            2948, 2953, 2958, 2963, 2968,
            2973, 2981, 2152, 2153, 3389,
            3390, 3391, 3428, 3429, 3562,
            3570, 3578, 3667, 3731, 3738,
            3832, 3846, 3851, 3856, 3858,
            3861, 3862, 3963
        });

        // type: 60
        RegisterAddons(60, new[]
        {
            2085, 2086, 2087, 2088, 2089,
            2090, 2091, 2092, 2093, 2094,
            2095, 2096, 2097, 2039, 2040,
            2041, 2042, 2043, 2044, 2045,
            2046, 2047, 2048, 2049, 2050,
            2051, 2052, 2053, 2054, 2055,
            2056, 2057, 2058, 2059, 2060,
            2061, 2062, 2063, 2064, 2144,
            2145, 2154, 2155, 2156, 2157,
            2269, 2274, 2309, 2310, 2979, 2980, 3008,
            3153, 3204, 3231, 3240, 3241,
            3242, 3243, 3244, 3245, 3246,
            3247, 3248, 3249, 3250, 3251,
            3265, 3266, 3310, 3311, 2285,
            2286, 2288, 2289, 2291, 2292,
            2294, 2295, 2297, 2298, 2312, 2315,
            2317, 2320, 2322, 2325, 2327, 2330,
            2332, 2335, 2337, 2340, 2342, 2345,
            2347, 2350, 2352, 2355, 2357, 2360,
            2759, 2762, 2764, 2767, 2769, 2772,
            2774, 2777, 2779, 2782, 2784, 2787,
            2789, 2792, 2794, 2797, 2799, 2802,
            2804, 2807, 2828, 2892, 2895, 2898,
            2902, 2906, 2910, 2924, 2926, 2929,
            2931, 2934, 2936, 2939, 2941, 2944,
            2946, 2949, 2951, 2954, 2956, 2959,
            2961, 2964, 2966, 2969, 2971, 3091,
            2158, 2159, 2160, 2161, 2162, 2163,
            2164, 2165, 3394, 3395, 3396, 3563,
            3571, 3579, 3668, 3699, 3700, 3730,
            3739, 3748, 3833, 3847, 3852, 3857,
            3859, 3964,
            3863, 3864, 3865
        });

        // type: 160
        RegisterAddons(160, new[]
        {
            3043, 3044, 3148, 3149,
            3150, 3151, 3196, 3209,
            3210, 3211, 3212, 3202,
            3236, 3237, 3238, 3611,
            3683, 3729, 3733, 3737,
            3921, 3876, 3913, 3920, 3901, 3889, 3912, 3877, 3900, 3888,
            3966, 3967
        });
    }

    private static void RegisterAddons(int relicAttributeType, int[] addonIds)
    {
        foreach (var addonId in addonIds)
        {
            AddonToRelicAttributeType[addonId] = relicAttributeType;
        }
    }

    /// <summary>
    /// Получить RelicAttributeId (type) по AddonId.
    /// </summary>
    /// <param name="addonId">ID аддона</param>
    /// <returns>RelicAttributeId (type) или null, если маппинг не найден</returns>
    public static int? GetRelicAttributeType(int addonId)
    {
        return AddonToRelicAttributeType.TryGetValue(addonId, out var type) ? type : null;
    }

    /// <summary>
    /// Проверить, существует ли маппинг для данного AddonId.
    /// </summary>
    /// <param name="addonId">ID аддона</param>
    /// <returns>true, если маппинг существует</returns>
    public static bool HasMapping(int addonId)
    {
        return AddonToRelicAttributeType.ContainsKey(addonId);
    }

    /// <summary>
    /// Получить все AddonId для указанного RelicAttributeId (type).
    /// </summary>
    /// <param name="relicAttributeType">RelicAttributeId (type)</param>
    /// <returns>Список AddonId</returns>
    public static IEnumerable<int> GetAddonsByType(int relicAttributeType)
    {
        return AddonToRelicAttributeType
            .Where(kvp => kvp.Value == relicAttributeType)
            .Select(kvp => kvp.Key);
    }
}
